<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accueil</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Accueil</h1>
        <form id="selectionForm" action="/saveSelections" method="POST">
            <table>
                <thead>
                    <tr>
                        <th>Heure\N° Projet</th>
                        <th>Projet 1</th>
                        <th>Projet 2</th>
                        <th>Projet 3</th>
                        <th>Projet 4</th>
                        <th>Projet 5</th>
                        <th>Projet 6</th>
                        <th>Projet 7</th>
                        <th>Projet 8</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>13h30</td>
                        <!-- Remplacez le contenu du formulaire par des boucles dynamiques si nécessaire -->
                        <td><input type="checkbox" name="selections[]" value="projet1"></td>
                        <td><input type="checkbox" name="selections[]" value="projet2"></td>
                        <td><input type="checkbox" name="selections[]" value="projet3"></td>
                        <td><input type="checkbox" name="selections[]" value="projet4"></td>
                        <td><input type="checkbox" name="selections[]" value="projet5"></td>
                        <td><input type="checkbox" name="selections[]" value="projet6"></td>
                        <td><input type="checkbox" name="selections[]" value="projet7"></td>
                        <td><input type="checkbox" name="selections[]" value="projet8"></td>
                    </tr>
                    <tr>
                        <td>14h00</td>
                        <td><input type="checkbox" name="selections[]" value="projet1"></td>
                        <td><input type="checkbox" name="selections[]" value="projet2"></td>
                        <td><input type="checkbox" name="selections[]" value="projet3"></td>
                        <td><input type="checkbox" name="selections[]" value="projet4"></td>
                        <td><input type="checkbox" name="selections[]" value="projet5"></td>
                        <td><input type="checkbox" name="selections[]" value="projet6"></td>
                        <td><input type="checkbox" name="selections[]" value="projet7"></td>
                        <td><input type="checkbox" name="selections[]" value="projet8"></td>
                    </tr>
                    <tr>
                        <td>14h30</td>
                        <td><input type="checkbox" name="selections[]" value="projet1"></td>
                        <td><input type="checkbox" name="selections[]" value="projet2"></td>
                        <td><input type="checkbox" name="selections[]" value="projet3"></td>
                        <td><input type="checkbox" name="selections[]" value="projet4"></td>
                        <td><input type="checkbox" name="selections[]" value="projet5"></td>
                        <td><input type="checkbox" name="selections[]" value="projet6"></td>
                        <td><input type="checkbox" name="selections[]" value="projet7"></td>
                        <td><input type="checkbox" name="selections[]" value="projet8"></td>
                    </tr>
                    <tr>
                        <td>15h00</td>
                        <td><input type="checkbox" name="selections[]" value="projet1,"></td>
                        <td><input type="checkbox" name="selections[]" value="projet2"></td>
                        <td><input type="checkbox" name="selections[]" value="projet3"></td>
                        <td><input type="checkbox" name="selections[]" value="projet4"></td>
                        <td><input type="checkbox" name="selections[]" value="projet5"></td>
                        <td><input type="checkbox" name="selections[]" value="projet6"></td>
                        <td><input type="checkbox" name="selections[]" value="projet7"></td>
                        <td><input type="checkbox" name="selections[]" value="projet8"></td>
                    </tr>
                    <tr>
                        <td>15h30</td>
                        <td><input type="checkbox" name="selections[]" value="projet1"></td>
                        <td><input type="checkbox" name="selections[]" value="projet2"></td>
                        <td><input type="checkbox" name="selections[]" value="projet3"></td>
                        <td><input type="checkbox" name="selections[]" value="projet4"></td>
                        <td><input type="checkbox" name="selections[]" value="projet5"></td>
                        <td><input type="checkbox" name="selections[]" value="projet6"></td>
                        <td><input type="checkbox" name="selections[]" value="projet7"></td>
                        <td><input type="checkbox" name="selections[]" value="projet8"></td>
                </tbody>
            </table>
            <button type="submit">Enregistrer les sélections</button>
        </form>
    </div>
    <script src="authentification.js">
        // Fonction pour récupérer les données et les afficher dans le tableau
        async function fetchData() {
            try {
                const response = await fetch('/data');
                const result = await response.json();
                const data = result.data;

                const tableBody = document.getElementById('table-body');
                tableBody.innerHTML = '';

                data.forEach(row => {
                    const tr = document.createElement('tr');
                    
                    // Ajout de la première colonne (Heure)
                    const heureTd = document.createElement('td');
                    heureTd.textContent = row.heure; // Assurez-vous que la colonne existe dans votre table
                    tr.appendChild(heureTd);

                    // Ajout des colonnes des projets
                    for (let i = 1; i <= 8; i++) {
                        const projetTd = document.createElement('td');
                        const input = document.createElement('input');
                        input.type = 'checkbox';
                        input.name = 'selections[]';
                        input.value = `projet${i}`;
                        if (row[`projet${i}`]) { // Si le projet est sélectionné dans la base de données
                            input.checked = true;
                        }
                        projetTd.appendChild(input);
                        tr.appendChild(projetTd);
                    }

                    tableBody.appendChild(tr);
                });
            } catch (error) {
                console.error('Erreur lors de la récupération des données:', error);
            }
        }

        // Appeler la fonction fetchData lorsque la page se charge
        window.onload = fetchData;
    </script>
</body>
</html>
